
if(!WOOSVIADM){var WOOSVIADM={}}else{if(WOOSVIADM&&typeof WOOSVIADM!=="object"){throw new Error("WOOSVIADM is not an Object type")}}WOOSVIADM.isLoaded=false;WOOSVIADM.STARTS=function(a){return{NAME:"Application initialize module",VERSION:1,init:function(){if(a("body").hasClass("woocommerce_page_woocommerce_svi")){this.loadInits();this.licenseOptions()}this.notices();this.initMedia();this.goMediaGallery();this.initMediaGal()},loadInits:function(){a("input#columns").attr("type","number").attr("min",1).attr("max",10);a("input#lens_size").attr("type","number").attr("min",100).attr("max",300);a("input#lightbox_width").attr("type","number").attr("min",10).attr("max",90);a("input#lightbox_height").attr("type","number").attr("min",100).attr("max",1000)},licenseOptions:function(){a("div.svival").hide();a("form#woosvi_license").submit(function(b){b.preventDefault();a(".notice").slideUp("fast").remove();a("div.svival").addClass("is-active").fadeIn();jQuery.ajax({url:ajaxurl,type:"post",dataType:"json",data:{action:"woosvi_licenseverify",data:a("form#woosvi_license").serialize()},success:function(c){a("div.svival.is-active").fadeOut(function(){if(c.status&&c.status!="warning"){a("form#woosvi_license").append('<div class="notice notice-success is-dismissible">'+c.message+". Page wil reload shorthly.</div>");setTimeout(function(){a(".notice.notice-success").slideUp("fast").fadeOut(function(){window.location.reload()})},2500)}else{if(c.status=="warning"){a("form#woosvi_license").append('<div class="notice notice-warning is-dismissible">'+c.message+"</div>")}else{a("form#woosvi_license").append('<div class="notice notice-error is-dismissible">'+c.message+"</div>")}}})}})})},notices:function(){jQuery(document).on("click",".woosvi-notice-dismissed .notice-dismiss",function(){jQuery.ajax({url:ajaxurl,data:{action:"woosvi_dismiss_notice"}})})},block:function(){a("#sviproimages_tab_data").block({message:null,overlayCSS:{background:"#fff",opacity:0.6}})},unblock:function(){a("#sviproimages_tab_data").unblock()},initMedia:function(){a("#svibulkbtn:not(.active)").on("click",function(){WOOSVIADM.STARTS.reloadSelect()})},reloadSelect:function(){WOOSVIADM.STARTS.block();var b=a("div#sviselect_container");jQuery.ajax({url:ajaxurl,type:"POST",dataType:"html",data:{action:"woosvi_reloadselect",data:a("#post_ID").val()},success:function(c){b.empty().append(c);WOOSVIADM.STARTS.unblock();a("select#sviprobulk").select2()}})},reload:function(){WOOSVIADM.STARTS.block();var b=a("div#sviproimages_tab_data");jQuery.ajax({url:ajaxurl,type:"POST",dataType:"html",data:{action:"woosvi_reload",data:a("#post_ID").val()},success:function(c){b.empty().append(c);a("select#sviprobulk").select2("destroy");a("div[id^=__wp-uploader]").remove();WOOSVIADM.STARTS.initMediaGal();WOOSVIADM.STARTS.goMediaGallery();WOOSVIADM.STARTS.unblock();a("select#sviprobulk").select2()}})},goMediaGallery:function(){a("#addsviprovariation").on("click",function(d){d.preventDefault();var c=a("div#svipro_clone").clone();var b=a("#sviprobulk").val();var f=b.join("_svipro_");$svikey=a("div[id^=svipro_]").size()-1;if(jQuery.inArray("sviproglobal",b)>=0&&b.length>1){return}if(f!==""&&a('div[data-svigal="'+f+'"]').length<1){a(c).attr("id","svipro_"+$svikey).removeClass("hidden").attr("data-svigal",f).attr("data-svikey",$svikey).attr("data-svislug",JSON.stringify(b)).find("h2 span").html(b.join(" + ").replace("sviproglobal","Global")+" Gallery");a(c).find("input.svipro-product_image_gallery").attr("name","sviproduct_image_gallery["+f+"]");a(c).prependTo("#svigallery");WOOSVIADM.STARTS.buildMediaGal(f,$svikey);WOOSVIADM.STARTS.removeMediaGallery(f,$svikey);WOOSVIADM.STARTS.removeElementMediaGallery(f,$svikey)}})},initMediaGal:function(){a("div[id^=svipro_]").each(function(c,b){WOOSVIADM.STARTS.buildMediaGal(a(this).data("svigal"),a(this).data("svikey"));WOOSVIADM.STARTS.removeMediaGallery(a(this).data("svigal"),a(this).data("svikey"));WOOSVIADM.STARTS.removeElementMediaGallery(a(this).data("svigal"),a(this).data("svikey"))})},buildMediaGal:function(g,c){var d;var e=a("#svipro_"+c).find("input.svipro-product_image_gallery");var b=a("#svipro_"+c).find("ul.product_images");var f=a("#product_images_container").find("ul.product_images");a("#svipro_"+c).find(".add_product_images_svipro").on("click","a",function(i){var h=a(this);i.preventDefault();if(d){d.open();return}d=wp.media.frames.product_gallery=wp.media({title:h.data("choose"),button:{text:h.data("update")},states:[new wp.media.controller.Library({title:h.data("choose"),filterable:"all",multiple:true})]});var j=setInterval(function(){if(a(d.el).find("li.attachment").length>0){a(d.el).find("li.attachment").on("click",function(){a(d.el).find("tr.compat-field-woosvi-slug").closest("table").remove()});clearInterval(j)}},50);d.on("select",function(){var l=d.state().get("selection");var k=e.val();var m=[];l.map(function(o){o=o.toJSON();if(o.id&&b.find('ul li.image[data-attachment_id="'+o.id+'"]').length<1){a("div#svigallery #svipro_nullsvi").find('ul li.image[data-attachment_id="'+o.id+'"]').remove();k=k?k+","+o.id:o.id;var n=o.sizes&&o.sizes.thumbnail?o.sizes.thumbnail.url:o.url;b.append('<li class="image" data-attachment_id="'+o.id+'"><img src="'+n+'" /><ul class="actions"><li><a href="#" class="delete" title="'+h.data("delete")+'">'+h.data("text")+"</a></li></ul></li>");a("select#attachments["+o.id+"][woosvi-slug]").val(g);if(a("#product_images_container").find('ul li.image[data-attachment_id="'+o.id+'"]').length<1){f.append('<li class="image" data-attachment_id="'+o.id+'"><img src="'+n+'" /><ul class="actions"><li><a href="#" class="delete" title="'+h.data("delete")+'">'+h.data("text")+"</a></li></ul></li>")}}});e.val(k);WOOSVIADM.STARTS.updateGal("div#svipro_nullsvi .svipro-product_image_gallery","div#svipro_nullsvi .svipro-product_images_container");WOOSVIADM.STARTS.updateGal("#product_image_gallery","#product_images_container")});d.open()})},removeMediaGallery:function(c,b){a("#svipro_"+b).on("click","a.sviprobulk_remove",function(d){d.preventDefault();var e=a(this).closest("div.svi-woocommerce-product-images").find("input.svipro-product_image_gallery").val().split(",");a(this).closest("div.svi-woocommerce-product-images").remove();a.each(e,function(g,f){if(a("#svigallery").find('ul li.image[data-attachment_id="'+f+'"]').length<1){a("#product_images_container").find('ul li.image[data-attachment_id="'+f+'"]').remove()}});WOOSVIADM.STARTS.updateGal("#product_image_gallery","#product_images_container")})},removeElementMediaGallery:function(c,b){a("#svipro_"+b).find(".svipro-product_images_container").on("click","a.delete",function(){var f=a(this).closest("li.image").attr("data-attachment_id");var e=a("#svipro_"+b).find("input.svipro-product_image_gallery");var d;a("select#attachments["+f+"][woosvi-slug]").val("");a(this).closest("li.image").remove();if(a("#svigallery").find('ul li.image[data-attachment_id="'+f+'"]').length<1){a("#product_images_container").find('ul li.image[data-attachment_id="'+f+'"]').remove()}WOOSVIADM.STARTS.updateGal("#product_image_gallery","#product_images_container");a.each(a("#svipro_"+b).find(".svipro-product_images_container ul.product_images li.image"),function(h,g){d=d?d+","+a(g).data("attachment_id"):a(g).data("attachment_id")});e.val(d);a("#tiptip_holder").removeAttr("style");a("#tiptip_arrow").removeAttr("style");return false});a("#product_images_container").on("click","a.delete",function(){var d=a(this).closest("li.image").attr("data-attachment_id");var h=a("div#svigallery").find('ul li.image[data-attachment_id="'+d+'"]');var f=h.closest("div.svipro-product_images_container");var e=f.find("input.svipro-product_image_gallery");h.remove();var g="";f.find("ul li.image").each(function(){var i=a(this).attr("data-attachment_id");g=g+i+","});e.val(g);return false})},updateGal:function(e,b){var d=a(e);var c="";a(b).find("ul li.image").each(function(){var f=a(this).attr("data-attachment_id");c=c?c+","+f:f});d.val(c)}}}(jQuery);jQuery(document).ready(function(){WOOSVIADM.STARTS.init()});